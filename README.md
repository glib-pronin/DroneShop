# Drones

**Drones** - це повнофункціональний інтернет-магазин на Flask з підтримкою офомрлення замовлень, кошика, онлайн-оплати, інтеграції нової Пошти, Telegram-сповіщень адміністратора та особистого кабінету користувача.

---
## Зміст
1. [Інтерфейс](#інтерфейс)
2. [Основні можливості](#основні-можливості)
3. [Використані технології](#використані-технології)
4. [Використані API](#використані-api)
5. [Налаштування .env файлу](#налаштування-env-файлу)
6. [Структура бази даних](#структура-бази-даних)
7. [Розробник](#розробник)
8. [Установка та запуск](#установка-та-запуск)
9. [Висновок](#висновок)

---
## Інтерфейс
Дизайн інтерфейсу був зроблений у Figma:
[Посиаллня на Figma](https://www.figma.com/design/HBsneKCybUJf8eQsBKxomk/Shop?node-id=263-19851&t=QaA5UmXsk4fmRK7X-1)

---
## Основні можливості

- Реєстрація, авторизація, відновлення паролю (відправка коду на електронну пошту);

- Кошик (додавання/виадлення товару, зміна кількості);

- Оформлення замовлення з інтеграцією Нової Пошти (міста, відділення та поштомати);

- Оплата замовлення онлайн за допомогою MonoPay;

- Контактна форма зв'язку (відправка повідомлення в Telegram адміністратора);

- Профіль користувача (дані підтягуються під час оформлення замовлення):
    
    - Контактні дан;

    - Мої замовлення;

    - Мої адреси.

- Повністю реалізований кошик (дані зберігаються в cookies)

---
## Використані технології

**Backend**
- Flask - основний веб-фреймворк;

- Flask-Login - система авторизації та сесій;

- Flask-Mail - відправка листів (скидання паролю);

- Flask-Migrate - керування міграціями;

- Flask-SQLAlchemy - ORM для роботи з базою даних;

- Flask-Limiter - ліміти для захисту форм (зв'язок з адміністратором);

- SQLite - легка вбудована база даних.

**Frontend**

- HTML5, CSS3;

- Jinja2 - шаблонізатор.

---
## Використані API

### 1. MonoPay API
- **Роль:** обробка онлайн-оплати.

- **Документація:** https://monobank.ua/api-docs

- **Приклад запиту**
``` python
import requests

mono_url = "https://api.monobank.ua/api/merchant/invoice/create"

data = {
    "amount": amount,      # сума в копійках (10000 = 100 грн)
    "ccy": 980,            # валюта: 980 = UAH
    "redirectUrl": "http://127.0.0.1:5000/success"  # повернення після оплати
}

resp = requests.post(
    url=mono_url,
    json=data,
    headers={"X-Token": mono_api_key}  # токен мерчанта MonoPay
)
```

- **Використовується для:**
    - редіректу користувача на оплату;
    - обробки статусів (через webhook).


### 2. Nova Posh
- **Роль:** пошук міст, відділень та поштоматів.

- **Документація:** https://developers.novaposhta.ua/

- **Приклад запиту**
``` python
import requests

url = 'https://api.novaposhta.ua/v2.0/json/'

data = {
    "apiKey": api_key, # api-ключ
    "modelName": "Address", # сервіс API
    "calledMethod": "getCities", # метод для отримання списку міст
    "methodProperties": {}
}
resp = requests.post(url, json=data, timeout=10)
```

- **Використовується для:**
    - отримання списку міст;
    - завантаження відділень/поштоматів.

### 3. Telegram Bot API
- **Роль:** відправка повідомлень адміністратору.

- **Документація:** https://core.telegram.org/bots/api

- **Приклад запиту**
``` python
import requests

url = f'https://api.telegram.org/bot{bot_token}/sendMessage''

data = {
        "chat_id": admin_chat_id, # id адміністратора
        "text": "..." # повідомлення
    }
    res = requests.post(url=url, data=data)
```

- **Використовується для:**
    - швидкого зворотного зв'язку.

---
## Налаштування .env файлу
```
# Flask
FLASK_APP = your_path_to_flask_app
SECRET_KEY = 'your_seckret_key

# Email
EMAIL = your_email
PASSWORD = your_email_password

# API (Mono, Nova Poshta)
API_NOVA_POSHTA = your_api_key
MONO_API = your_token

# Telegram
BOT_TOKEN = your_bot_token
ADMIN_CHAT_ID = admin_id
```

---
## Структура бази даних
**Основні таблиці:**
|Таблиця|Опис|
|-------|----|
|users|Користувачі, використовується для авторизації|
|credentials|Особисті дані користувача, підтягуються під час оформлення замовлення|
|products|Товари, уся інформація про них|
|sections|Секція опису товару, має зв'язок один до багатьох з таблицею products|
|orders|Замовлення користувача|
|destinations|Адреси замовлення користувача, підтягуються під час оформлення замовлення|

---
## Розробник
- Ім’я: Гліб Пронін
- Роль: Розробник інтернет-магазину "Drones"
- GitHub: [glib-pronin](https://github.com/)

---
## Установка та запуск

1. клонування репозиторію:
```
git clone <тут посилання>
cd drones
```

2. Встановлення залежностей:  
```
pip install -r requirements.txt
```

3. Налаштування:   
    - Створити .env

3. Запуск:  
```
python manage.py
```
